<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relatório de Passagem de Turno</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            color: #333;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: auto;
            background: #fff;
            padding: 20px 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .logo-container {
            text-align: center;
            margin-bottom: 20px;
        }
        .logo-container img {
            max-width: 200px; /* Ajuste o tamanho conforme a sua preferência */
            height: auto;
        }
        h1, h2 {
            color: #2c5aa0;
            border-bottom: 2px solid #4a7bc8;
            padding-bottom: 10px;
            margin-top: 20px;
        }
        label {
            display: block;
            margin-top: 15px;
            font-weight: bold;
        }
        input[type="text"], input[type="date"], textarea {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        textarea {
            resize: vertical;
        }
        .section {
            margin-bottom: 20px;
            border: 1px solid #e0e0e0;
            padding: 15px;
            border-radius: 8px;
        }
        .add-button {
            background-color: #4a7bc8;
            color: white;
            padding: 8px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        .add-button:hover {
            background-color: #2c5aa0;
        }
        .submit-button {
            display: block;
            width: 100%;
            padding: 15px;
            background-color: #2c5aa0;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 30px;
        }
        .submit-button:hover {
            background-color: #1a3c63;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="logo-container">
        <img src="Stellantis-Logo2.jpg" alt="Logo da Stellantis">
    </div>
    <h1>Relatório de Passagem de Turno</h1>
    <form id="reportForm">
        <div class="section">
            <h2>Informações Gerais</h2>
            <label for="data">Data:</label>
            <input type="date" id="data" name="data" required>
            <label for="turno">Turno:</label>
            <input type="text" id="turno" name="turno" value="2º turno" required>
            <label for="liderPresente">Líder(es) presente(s):</label>
            <input type="text" id="liderPresente" name="liderPresente" required>
            <label for="absenteismo">Absenteísmo:</label>
            <input type="text" id="absenteismo" name="absenteismo" value="Zero" required>
            <label for="liderProximoTurno">Líder próximo turno:</label>
            <input type="text" id="liderProximoTurno" name="liderProximoTurno" required>
        </div>
        <div class="section">
            <h2>Status dos Equipamentos</h2>
            <h3>1.1 Energy Center</h3>
            <h4>Compressores</h4>
            <label for="energyCompressoresOperacao">Em operação:</label>
            <input type="text" id="energyCompressoresOperacao" name="energyCompressoresOperacao" placeholder="Ex: 01, 03, 04, 05">
            <label for="energyCompressoresBackup">Backup:</label>
            <input type="text" id="energyCompressoresBackup" name="energyCompressoresBackup" placeholder="Ex: 02, 07">
            <label for="energyCompressoresManutencao">Em manutenção:</label>
            <input type="text" id="energyCompressoresManutencao" name="energyCompressoresManutencao" placeholder="Ex: 06">
            <label for="energyCompressoresSP">Set Point (SP):</label>
            <input type="text" id="energyCompressoresSP" name="energyCompressoresSP" placeholder="Ex: 8.5">
            <label for="energyCompressoresObs">Observações:</label>
            <textarea id="energyCompressoresObs" name="energyCompressoresObs" rows="1"></textarea>
            <h4>Torres</h4>
            <label for="torresOperacao">Em operação:</label>
            <input type="text" id="torresOperacao" name="torresOperacao" placeholder="Ex: 02, 03, 04, 05, 07, 08">
            <label for="torresBackup">Backup:</label>
            <input type="text" id="torresBackup" name="torresBackup" placeholder="Ex: 01, 06, 09, 11, 12">
            <label for="torresManutencao">Em manutenção:</label>
            <input type="text" id="torresManutencao" name="torresManutencao" placeholder="Ex: 10">
            <label for="torresObs">Observações:</label>
            <textarea id="torresObs" name="torresObs" rows="1"></textarea>
            <h4>Secadores</h4>
            <label for="energySecadoresOperacao">Em operação:</label>
            <input type="text" id="energySecadoresOperacao" name="energySecadoresOperacao" placeholder="Ex: 01, 02, 03">
            <label for="energySecadoresBackup">Backup:</label>
            <input type="text" id="energySecadoresBackup" name="energySecadoresBackup" placeholder="">
            <label for="energySecadoresManutencao">Em manutenção:</label>
            <input type="text" id="energySecadoresManutencao" name="energySecadoresManutencao" placeholder="">
            <label for="energySecadoresObs">Observações:</label>
            <textarea id="energySecadoresObs" name="energySecadoresObs" rows="1"></textarea>
            <h4>Chillers</h4>
            <label for="chillersOperacao">Em operação:</label>
            <input type="text" id="chillersOperacao" name="chillersOperacao" placeholder="Ex: 03, 04">
            <label for="chillersBackup">Backup:</label>
            <input type="text" id="chillersBackup" name="chillersBackup" placeholder="Ex: 01, 02, 05, 08">
            <label for="chillersManutencao">Em manutenção:</label>
            <input type="text" id="chillersManutencao" name="chillersManutencao" placeholder="Ex: 06, 07, 09">
            <label for="chillersObs">Observações:</label>
            <textarea id="chillersObs" name="chillersObs" rows="1"></textarea>
            <h4>Bombas CW</h4>
            <label for="bombasCWOperacao">Em operação:</label>
            <input type="text" id="bombasCWOperacao" name="bombasCWOperacao" placeholder="Ex: 01, 04, 05">
            <label for="bombasCWBackup">Backup:</label>
            <input type="text" id="bombasCWBackup" name="bombasCWBackup" placeholder="Ex: 02, 03, 06">
            <label for="bombasCWManutencao">Em manutenção:</label>
            <input type="text" id="bombasCWManutencao" name="bombasCWManutencao" placeholder="">
            <label for="bombasCWObs">Observações:</label>
            <textarea id="bombasCWObs" name="bombasCWObs" rows="1"></textarea>
            <h4>Bombas CHW</h4>
            <label for="bombasCHWOperacao">Em operação:</label>
            <input type="text" id="bombasCHWOperacao" name="bombasCHWOperacao" placeholder="Ex: 02, 06, 08">
            <label for="bombasCHWBackup">Backup:</label>
            <input type="text" id="bombasCHWBackup" name="bombasCHWBackup" placeholder="Ex: 03, 05, 07, 09">
            <label for="bombasCHWManutencao">Em manutenção:</label>
            <input type="text" id="bombasCHWManutencao" name="bombasCHWManutencao" placeholder="Ex: 01, 04">
            <label for="bombasCHWObs">Observações:</label>
            <textarea id="bombasCHWObs" name="bombasCHWObs" rows="1"></textarea>
            <h3>1.2 Central de Ar</h3>
            <h4>Compressores</h4>
            <label for="centralArCompressoresOperacao">Em operação:</label>
            <input type="text" id="centralArCompressoresOperacao" name="centralArCompressoresOperacao" placeholder="Ex: 03, 04">
            <label for="centralArCompressoresBackup">Backup:</label>
            <input type="text" id="centralArCompressoresBackup" name="centralArCompressoresBackup" placeholder="">
            <label for="centralArCompressoresManutencao">Em manutenção:</label>
            <input type="text" id="centralArCompressoresManutencao" name="centralArCompressoresManutencao" placeholder="Ex: 01, 05">
            <label for="centralArCompressoresObs">Observações:</label>
            <textarea id="centralArCompressoresObs" name="centralArCompressoresObs" rows="1"></textarea>
            <h4>Secadores</h4>
            <label for="centralArSecadoresOperacao">Em operação:</label>
            <input type="text" id="centralArSecadoresOperacao" name="centralArSecadoresOperacao" placeholder="Ex: 02, 03, 04, 05">
            <label for="centralArSecadoresEmEspera">Em espera:</label>
            <input type="text" id="centralArSecadoresEmEspera" name="centralArSecadoresEmEspera" placeholder="">
            <label for="centralArSecadoresManutencao">Em manutenção:</label>
            <input type="text" id="centralArSecadoresManutencao" name="centralArSecadoresManutencao" placeholder="Ex: 01">
            <label for="centralArSecadoresObs">Observações:</label>
            <textarea id="centralArSecadoresObs" name="centralArSecadoresObs" rows="1"></textarea>
        </div>
        <div class="section">
            <h2>Atividades Programadas</h2>
            <h3>Mecânica</h3>
            <div id="mecanica-fields">
                <div class="atividade-item">
                    <label for="mecanicaOrdem0">Ordem:</label>
                    <input type="text" id="mecanicaOrdem0" name="mecanicaOrdem[]">
                    <label for="mecanicaDescricao0">Descrição:</label>
                    <textarea id="mecanicaDescricao0" name="mecanicaDescricao[]" rows="2"></textarea>
                    <label for="mecanicaStatus0">Status:</label>
                    <input type="text" id="mecanicaStatus0" name="mecanicaStatus[]" placeholder="Ex: Realizada, Não realizada, Pendente">
                    <label for="mecanicaObservacoes0">Observações:</label>
                    <textarea id="mecanicaObservacoes0" name="mecanicaObservacoes[]" rows="2"></textarea>
                </div>
            </div>
            <button type="button" class="add-button" onclick="addActivityField('mecanica')">Adicionar Atividade Mecânica</button>
            <h3>Elétrica</h3>
            <div id="eletrica-fields">
                <div class="atividade-item">
                    <label for="eletricaOrdem0">Ordem:</label>
                    <input type="text" id="eletricaOrdem0" name="eletricaOrdem[]">
                    <label for="eletricaDescricao0">Descrição:</label>
                    <textarea id="eletricaDescricao0" name="eletricaDescricao[]" rows="2"></textarea>
                    <label for="eletricaStatus0">Status:</label>
                    <input type="text" id="eletricaStatus0" name="eletricaStatus[]" placeholder="Ex: Realizada, Não realizada, Pendente">
                    <label for="eletricaObservacoes0">Observações:</label>
                    <textarea id="eletricaObservacoes0" name="eletricaObservacoes[]" rows="2"></textarea>
                </div>
            </div>
            <button type="button" class="add-button" onclick="addActivityField('eletrica')">Adicionar Atividade Elétrica</button>
        </div>
        <div class="section">
            <h2>Atividades Extras e Observações</h2>
            <h3>Atividades Extras</h3>
            <div id="extra-fields">
                <div class="atividade-item">
                    <label for="extraOrdem0">Ordem:</label>
                    <input type="text" id="extraOrdem0" name="extraOrdem[]">
                    <label for="extraDescricao0">Descrição:</label>
                    <textarea id="extraDescricao0" name="extraDescricao[]" rows="2"></textarea>
                    <label for="extraStatus0">Status:</label>
                    <input type="text" id="extraStatus0" name="extraStatus[]" placeholder="Ex: Realizada, Não realizada, Pendente">
                    <label for="extraObservacoes0">Observações:</label>
                    <textarea id="extraObservacoes0" name="extraObservacoes[]" rows="2"></textarea>
                </div>
            </div>
            <button type="button" class="add-button" onclick="addActivityField('extra')">Adicionar Atividade Extra</button>
            <h3>Observações Importantes</h3>
            <div id="observacoes-fields">
                <div class="observacao-item">
                    <label for="observacoes0">Observação 1:</label>
                    <textarea id="observacoes0" name="observacoes[]" rows="2"></textarea>
                </div>
            </div>
            <button type="button" class="add-button" onclick="addObservationField()">Adicionar Observação</button>
        </div>
        <button type="submit" class="submit-button">Gerar PDF do Relatório</button>
    </form>
</div>
<script>
    function addActivityField(type) {
        const container = document.getElementById(`${type}-fields`);
        const index = container.querySelectorAll('.atividade-item').length;
        const div = document.createElement('div');
        div.className = 'atividade-item';
        div.innerHTML = `
            <hr>
            <label for="${type}Ordem${index}">Ordem:</label>
            <input type="text" id="${type}Ordem${index}" name="${type}Ordem[]">
            <label for="${type}Descricao${index}">Descrição:</label>
            <textarea id="${type}Descricao${index}" name="${type}Descricao[]" rows="2"></textarea>
            <label for="${type}Status${index}">Status:</label>
            <input type="text" id="${type}Status${index}" name="${type}Status[]" placeholder="Ex: Realizada, Não realizada, Pendente">
            <label for="${type}Observacoes${index}">Observações:</label>
            <textarea id="${type}Observacoes${index}" name="${type}Observacoes[]" rows="2"></textarea>
        `;
        container.appendChild(div);
    }
    function addObservationField() {
        const container = document.getElementById('observacoes-fields');
        const index = container.querySelectorAll('.observacao-item').length;
        const div = document.createElement('div');
        div.className = 'observacao-item';
        div.innerHTML = `
            <label for="observacoes${index}">Observação ${index + 1}:</label>
            <textarea id="observacoes${index}" name="observacoes[]" rows="2"></textarea>
        `;
        container.appendChild(div);
    }
    document.getElementById('reportForm').addEventListener('submit', async (event) => {
        event.preventDefault();
        const form = event.target;
        const formData = new FormData(form);
        const data = {};
        data.data = formData.get('data');
        data.turno = formData.get('turno');
        data.liderPresente = formData.get('liderPresente');
        data.absenteismo = formData.get('absenteismo');
        data.liderProximoTurno = formData.get('liderProximoTurno');
        data.energyCompressoresOperacao = formData.get('energyCompressoresOperacao');
        data.energyCompressoresBackup = formData.get('energyCompressoresBackup');
        data.energyCompressoresManutencao = formData.get('energyCompressoresManutencao');
        data.energyCompressoresSP = formData.get('energyCompressoresSP');
        data.energyCompressoresObs = formData.get('energyCompressoresObs');
        data.torresOperacao = formData.get('torresOperacao');
        data.torresBackup = formData.get('torresBackup');
        data.torresManutencao = formData.get('torresManutencao');
        data.torresObs = formData.get('torresObs');
        data.energySecadoresOperacao = formData.get('energySecadoresOperacao');
        data.energySecadoresBackup = formData.get('energySecadoresBackup');
        data.energySecadoresManutencao = formData.get('energySecadoresManutencao');
        data.energySecadoresObs = formData.get('energySecadoresObs');
        data.chillersOperacao = formData.get('chillersOperacao');
        data.chillersBackup = formData.get('chillersBackup');
        data.chillersManutencao = formData.get('chillersManutencao');
        data.chillersObs = formData.get('chillersObs');
        data.bombasCWOperacao = formData.get('bombasCWOperacao');
        data.bombasCWBackup = formData.get('bombasCWBackup');
        data.bombasCWManutencao = formData.get('bombasCWManutencao');
        data.bombasCWObs = formData.get('bombasCWObs');
        data.bombasCHWOperacao = formData.get('bombasCHWOperacao');
        data.bombasCHWBackup = formData.get('bombasCHWBackup');
        data.bombasCHWManutencao = formData.get('bombasCHWManutencao');
        data.bombasCHWObs = formData.get('bombasCHWObs');
        data.centralArCompressoresOperacao = formData.get('centralArCompressoresOperacao');
        data.centralArCompressoresBackup = formData.get('centralArCompressoresBackup');
        data.centralArCompressoresManutencao = formData.get('centralArCompressoresManutencao');
        data.centralArCompressoresObs = formData.get('centralArCompressoresObs');
        data.centralArSecadoresOperacao = formData.get('centralArSecadoresOperacao');
        data.centralArSecadoresEmEspera = formData.get('centralArSecadoresEmEspera');
        data.centralArSecadoresManutencao = formData.get('centralArSecadoresManutencao');
        data.centralArSecadoresObs = formData.get('centralArSecadoresObs');
        data.mecanicaOrdem = formData.getAll('mecanicaOrdem[]');
        data.mecanicaDescricao = formData.getAll('mecanicaDescricao[]');
        data.mecanicaStatus = formData.getAll('mecanicaStatus[]');
        data.mecanicaObservacoes = formData.getAll('mecanicaObservacoes[]');
        data.eletricaOrdem = formData.getAll('eletricaOrdem[]');
        data.eletricaDescricao = formData.getAll('eletricaDescricao[]');
        data.eletricaStatus = formData.getAll('eletricaStatus[]');
        data.eletricaObservacoes = formData.getAll('eletricaObservacoes[]');
        data.extraOrdem = formData.getAll('extraOrdem[]');
        data.extraDescricao = formData.getAll('extraDescricao[]');
        data.extraStatus = formData.getAll('extraStatus[]');
        data.extraObservacoes = formData.getAll('extraObservacoes[]');
        data.observacoes = formData.getAll('observacoes[]');
        for (const key in data) {
            if (Array.isArray(data[key])) {
                data[key] = data[key].filter(item => item.trim() !== '');
            } else if (typeof data[key] === 'string' && data[key].trim() === '') {
                delete data[key];
            }
        }
        try {
            const response = await fetch('/gerar-pdf', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });
            if (response.ok) {
                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = `relatorio_passagem_turno_${data.data}.pdf`;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
            } else {
                const error = await response.json();
                alert('Erro ao gerar o PDF: ' + error.error);
            }
        } catch (error) {
            console.error('Erro:', error);
            alert('Erro de conexão com o servidor.');
        }
    });
</script>
</body>
</html>